var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282, 278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273, 271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23, 23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24]; function stackBlurImage(C,J,I,w){var C=document.getElementById(C),D=C.naturalWidth,q=C.naturalHeight,A=document.getElementById(J);A.style.width=D+"px";A.style.height=q+"px";A.width=D;A.height=q;A=A.getContext("2d");A.clearRect(0,0,D,q);A.drawImage(C,0,0);isNaN(I)||1>I||(w?stackBlurCanvasRGBA(J,0,0,D,q,I):stackBlurCanvasRGB(J,0,0,D,q,I))} function stackBlurCanvasRGBA(C,J,I,w,D,q){if(!(isNaN(q)||1>q)){var q=q|0,C=document.getElementById(C).getContext("2d"),A;try{try{A=C.getImageData(J,I,w,D)}catch(R){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),A=C.getImageData(J,I,w,D)}catch(O){throw alert("Cannot access local image"),Error("unable to access local image data: "+O);}}}catch(P){throw alert("Cannot access image"),Error("unable to access image data: "+P);}var b=A.data,t,E,a,c,d,L,h,i,j,k,u,v,r,s,l,m,n, p,x,z,B,f,F;t=q+q+1;var K=w-1,g=D-1,y=q+1,G=y*(y+1)/2,H=new BlurStack,e=H;for(a=1;a<t;a++)if(e=e.next=new BlurStack,a==y)var Q=e;e.next=H;e=a=null;L=d=0;var M=mul_table[q],N=shg_table[q];for(E=0;E<D;E++){l=m=n=p=h=i=j=k=0;u=y*(x=b[d]);v=y*(z=b[d+1]);r=y*(B=b[d+2]);s=y*(f=b[d+3]);h+=G*x;i+=G*z;j+=G*B;k+=G*f;e=H;for(a=0;a<y;a++)e.r=x,e.g=z,e.b=B,e.a=f,e=e.next;for(a=1;a<y;a++)c=d+((K<a?K:a)<<2),h+=(e.r=x=b[c])*(F=y-a),i+=(e.g=z=b[c+1])*F,j+=(e.b=B=b[c+2])*F,k+=(e.a=f=b[c+3])*F,l+=x,m+=z,n+=B,p+=f,e= e.next;a=H;e=Q;for(t=0;t<w;t++)b[d+3]=f=k*M>>N,0!=f?(f=255/f,b[d]=(h*M>>N)*f,b[d+1]=(i*M>>N)*f,b[d+2]=(j*M>>N)*f):b[d]=b[d+1]=b[d+2]=0,h-=u,i-=v,j-=r,k-=s,u-=a.r,v-=a.g,r-=a.b,s-=a.a,c=L+((c=t+q+1)<K?c:K)<<2,l+=a.r=b[c],m+=a.g=b[c+1],n+=a.b=b[c+2],p+=a.a=b[c+3],h+=l,i+=m,j+=n,k+=p,a=a.next,u+=x=e.r,v+=z=e.g,r+=B=e.b,s+=f=e.a,l-=x,m-=z,n-=B,p-=f,e=e.next,d+=4;L+=w}for(t=0;t<w;t++){m=n=p=l=i=j=k=h=0;d=t<<2;u=y*(x=b[d]);v=y*(z=b[d+1]);r=y*(B=b[d+2]);s=y*(f=b[d+3]);h+=G*x;i+=G*z;j+=G*B;k+=G*f;e=H;for(a= 0;a<y;a++)e.r=x,e.g=z,e.b=B,e.a=f,e=e.next;c=w;for(a=1;a<=q;a++)d=c+t<<2,h+=(e.r=x=b[d])*(F=y-a),i+=(e.g=z=b[d+1])*F,j+=(e.b=B=b[d+2])*F,k+=(e.a=f=b[d+3])*F,l+=x,m+=z,n+=B,p+=f,e=e.next,a<g&&(c+=w);d=t;a=H;e=Q;for(E=0;E<D;E++)c=d<<2,b[c+3]=f=k*M>>N,0<f?(f=255/f,b[c]=(h*M>>N)*f,b[c+1]=(i*M>>N)*f,b[c+2]=(j*M>>N)*f):b[c]=b[c+1]=b[c+2]=0,h-=u,i-=v,j-=r,k-=s,u-=a.r,v-=a.g,r-=a.b,s-=a.a,c=t+((c=E+y)<g?c:g)*w<<2,h+=l+=a.r=b[c],i+=m+=a.g=b[c+1],j+=n+=a.b=b[c+2],k+=p+=a.a=b[c+3],a=a.next,u+=x=e.r,v+=z=e.g, r+=B=e.b,s+=f=e.a,l-=x,m-=z,n-=B,p-=f,e=e.next,d+=w}C.putImageData(A,J,I)}} function stackBlurCanvasRGB(C,J,I,w,D,q){if(!(isNaN(q)||1>q)){var q=q|0,C=document.getElementById(C).getContext("2d"),A;try{try{A=C.getImageData(J,I,w,D)}catch(R){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),A=C.getImageData(J,I,w,D)}catch(O){throw alert("Cannot access local image"),Error("unable to access local image data: "+O);}}}catch(P){throw alert("Cannot access image"),Error("unable to access image data: "+P);}var b=A.data,t,E,a,c,d,L,h,i,j,k,u,v,r,s,l,m,n, p,x;t=q+q+1;var z=w-1,B=D-1,f=q+1,F=f*(f+1)/2,K=new BlurStack,g=K;for(a=1;a<t;a++)if(g=g.next=new BlurStack,a==f)var y=g;g.next=K;g=a=null;L=d=0;var G=mul_table[q],H=shg_table[q];for(E=0;E<D;E++){r=s=l=h=i=j=0;k=f*(m=b[d]);u=f*(n=b[d+1]);v=f*(p=b[d+2]);h+=F*m;i+=F*n;j+=F*p;g=K;for(a=0;a<f;a++)g.r=m,g.g=n,g.b=p,g=g.next;for(a=1;a<f;a++)c=d+((z<a?z:a)<<2),h+=(g.r=m=b[c])*(x=f-a),i+=(g.g=n=b[c+1])*x,j+=(g.b=p=b[c+2])*x,r+=m,s+=n,l+=p,g=g.next;a=K;g=y;for(t=0;t<w;t++)b[d]=h*G>>H,b[d+1]=i*G>>H,b[d+2]= j*G>>H,h-=k,i-=u,j-=v,k-=a.r,u-=a.g,v-=a.b,c=L+((c=t+q+1)<z?c:z)<<2,r+=a.r=b[c],s+=a.g=b[c+1],l+=a.b=b[c+2],h+=r,i+=s,j+=l,a=a.next,k+=m=g.r,u+=n=g.g,v+=p=g.b,r-=m,s-=n,l-=p,g=g.next,d+=4;L+=w}for(t=0;t<w;t++){s=l=r=i=j=h=0;d=t<<2;k=f*(m=b[d]);u=f*(n=b[d+1]);v=f*(p=b[d+2]);h+=F*m;i+=F*n;j+=F*p;g=K;for(a=0;a<f;a++)g.r=m,g.g=n,g.b=p,g=g.next;c=w;for(a=1;a<=q;a++)d=c+t<<2,h+=(g.r=m=b[d])*(x=f-a),i+=(g.g=n=b[d+1])*x,j+=(g.b=p=b[d+2])*x,r+=m,s+=n,l+=p,g=g.next,a<B&&(c+=w);d=t;a=K;g=y;for(E=0;E<D;E++)c= d<<2,b[c]=h*G>>H,b[c+1]=i*G>>H,b[c+2]=j*G>>H,h-=k,i-=u,j-=v,k-=a.r,u-=a.g,v-=a.b,c=t+((c=E+f)<B?c:B)*w<<2,h+=r+=a.r=b[c],i+=s+=a.g=b[c+1],j+=l+=a.b=b[c+2],a=a.next,k+=m=g.r,u+=n=g.g,v+=p=g.b,r-=m,s-=n,l-=p,g=g.next,d+=w}C.putImageData(A,J,I)}}function BlurStack(){this.a=this.b=this.g=this.r=0;this.next=null};